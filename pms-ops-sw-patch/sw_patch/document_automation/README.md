# documanet_automation
"PMS SW 패치 현황 및 검증서" 문서의 데이터를 자동으로 최신화하는 Python 스크립트입니다. <br>
최신 검증서 시트의 정보를 SW 현황 시트에 반영하여 최신 패치 정보를 유지할 수 있도록 합니다.  

## 기능  
- "PMS SW 패치 현황 및 검증서" 문서에서 특정 시트를 검색하여 불러옴  
- SW 현황 시트와 최신 검증서 시트를 비교하여 동일한 제품명을 식별  
- 최신 검증서 시트에서 발표일, 버전, 패치 파일 정보를 추출하여 SW 현황 시트에 반영  
- 변경된 항목을 로깅하여 콘솔에 출력  

## 프로젝트 구조
```
├─sw_patch
│  └─document_automation
│          README.md
│          sw_status_auto_updater.py
│          sw_status_auto_updater.ts
│          sw_status_auto_updater.vba
```
* 해당 디렉터리에 있는 `sw_status_auto_updater.py` 및 `sw_status_auto_updater.vba` 파일은 실행용이 아닙니다.  
    - 이전 작업 과정에서 생성된 파일로, 참고용으로 남겨두었습니다.  
    - 해당 디렉터리에서는 `sw_status_auto_updater.ts` 파일만 사용됩니다.  

## 실행 환경  
해당 스크립트는 SharePoint Office 365 Excel의 `자동화` 기능을 통해 실행됩니다.  
- `"PMS SW 패치 현황 및 검증서"` 문서 내 `자동화` > `sw_status_auto_updater` 스크립트가 등록되어 있으며, 이를 사용하면 자동으로 실행됩니다.
- 추가로, 등록되어 있는 `sw_status_auto_updater_test`는 코드 변경이 필요한 경우 사용하며, 엑셀 파일 변동 가능성이 있는 테스트를 진행할 경우 새로운 엑셀 시트를 생성하여 테스트해야 합니다.  
- Office 365 Excel의 작업 자동화 기능을 통해 매일 00시에 스크립트가 자동 실행됩니다.  

### 주의사항  
- 진행 중인 일반 SW 패치 검증이 당일 검증 및 배포되지 않았을 경우, 데이터가 업데이트되지 않아야 합니다.  
- 당일 검증 및 배포가 완료되지 않았다면, 자동화 기능을 비활성화해야 합니다.  

## 실행 방법  
1. **자동 실행**: 매일 **00시**에 자동 실행됨  
2. **수동 실행**: SW 현황 시트 상단의 `sw_status_auto_updater` 단추를 클릭하여 실행 가능  

## 코드 진행 순서  
1. *"PMS SW 패치 현황 및 검증서"* 문서를 불러옴  
2. SW 현황 시트 및 최신 검증서 시트를 찾음  
3. 최신 검증서 시트에서 제품명, 발표일, 버전, 패치 파일 정보를 추출  
4. SW 현황 시트에서 동일한 제품명을 찾아 최신 정보를 업데이트  
5. 변경된 정보를 로깅하여 출력  

## 로깅  
업데이트된 제품 정보는 아래 형식으로 콘솔에 출력됩니다:  
```plaintext
[제품명: 제품A, 발표일: 2025-02-05, 패치 파일: patch_v1.0.exe, 버전: 1.0.0]
[제품명: 제품B, 발표일: 2025-02-05, 패치 파일: patch_v2.0.exe, 버전: 2.0.0]
```

## 참고 사항  
- 최신 검증서 시트의 명칭은 **"YYYY-MM-DD 검증서"** 형식이어야 합니다.  
- SW 현황 시트의 명칭은 **"SW현황"** 이어야 합니다.  
- 제품명이 정확히 일치해야 데이터가 업데이트됩니다.